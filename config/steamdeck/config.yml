# Bootible Configuration - Steam Deck
# ====================================
# Default settings for Steam Deck setup.
#
# To customize: Create a private overlay repo and override these values
# in private/steamdeck/config.yml. See README.md for details.
#
# Or edit this file directly if you've forked the repo.

---
# =============================================================================
# SYSTEM
# =============================================================================
# Hostname and network configuration.

# Create a btrfs snapshot of /home before making changes
create_snapshot: true

# Hostname - leave empty to keep current hostname
# Example: "steamdeck" or "deck-living-room"
hostname: ""

# Static IP configuration
# Leave enabled: false to use DHCP (default)
static_ip:
  enabled: false
  connection: "Wired connection 1"  # NetworkManager connection name (use 'nmcli con show')
  address: ""       # e.g., "192.168.1.100/24"
  gateway: ""       # e.g., "192.168.1.1"
  dns:              # DNS servers
    - ""            # e.g., "8.8.8.8"
    # - ""          # e.g., "8.8.4.4"

# =============================================================================
# API SETTINGS
# =============================================================================
# GitHub API rate limits anonymous requests to 60/hour. If you hit rate limits
# (e.g., installing many Decky plugins), authentication is required.
#
# AUTOMATIC AUTH (Recommended):
# If you enable >3 Decky plugins, the bootstrap script will automatically show
# a QR code for GitHub login - just scan with your phone, no typing needed!
# The token is stored via `gh auth` and passed to the playbook automatically.
#
# MANUAL AUTH (Alternative):
# Create a token at: https://github.com/settings/tokens (no scopes needed)
# Put it in your private config (private/steamdeck/config.yml), not here!
github_token: ""

# =============================================================================
# PACKAGE MANAGERS
# =============================================================================
# Which package managers to use for installing software.
# Note: Only Flatpak survives SteamOS updates. Others require reinstall.

package_managers:
  flatpak: true       # Flatpak/Flathub - recommended, survives updates
  pacman: false       # Arch pacman - requires unlocking filesystem, lost on updates
  nix: false          # Nix package manager - survives updates, advanced users

# =============================================================================
# DESKTOP APPLICATIONS (Flatpak)
# =============================================================================
# Apps installed via Flatpak from Flathub. These survive SteamOS updates.

install_flatpak_apps: true

# Communication
install_discord: false
install_signal: false

# Media
install_spotify: false
install_vlc: false

# Browsers
install_firefox: false      # Pre-installed on SteamOS, but Flatpak version is more up-to-date
install_chromium: false

# Productivity
install_obs: false
install_vscode: false

# Utilities
install_flatseal: true      # Manage Flatpak permissions - highly recommended

# Password Manager
# ----------------
# Choose your password manager and installation method.
#
# Options for password_manager:
#   - "1password"  : 1Password (paid)
#   - "bitwarden"  : Bitwarden (free/paid)
#   - "keepassxc"  : KeePassXC (free, local-only)
#   - "protonpass" : Proton Pass (free/paid)
#   - "none"       : Don't install a password manager
#
# Options for password_manager_install_method:
#   - "flatpak"    : Easier, but limited features (no system auth, no SSH agent)
#   - "distrobox"  : Full features via Arch container (recommended for 1Password)
#
password_manager: "none"
password_manager_install_method: "flatpak"

# Remote Access Apps
install_anydesk: false

# Gaming Utilities
install_chiaki: false       # PlayStation Remote Play (Chiaki4deck)
install_cryoutilities: false  # Performance tweaks

# Game Streaming Clients
install_moonlight: false    # Stream games FROM another PC running Sunshine/GeForce
install_greenlight: false   # Xbox/xCloud game streaming

# Controller Utilities
# https://github.com/DiscreteTom/stickdeck-rs
install_stickdeck: false    # Use Steam Deck as wireless controller for PC

# Media Streaming
install_plex: false
install_jellyfin: false

# Communication (Additional)
install_telegram: false
install_slack: false
install_element: false
install_zoom: false

# Productivity (Additional)
install_libreoffice: false
install_gimp: false
install_thunderbird: false

# Utilities (Additional)
install_syncthing: false
install_qbittorrent: false
install_filezilla: false

# Gaming Launchers
install_heroic: false       # Epic Games / GOG launcher
install_lutris: false       # Game launcher for non-Steam games
install_bottles: false      # Wine prefix manager

# Development
install_neovim: false

# =============================================================================
# REMOTE ACCESS
# =============================================================================

# SSH
# ---
# SSH server for remote access and key management.
#
# SECURITY CONSIDERATIONS:
# - Password auth on default port 22 is an attack surface on public WiFi
# - For better security, consider:
#   1. Use SSH keys instead of passwords (import from private repo)
#   2. Change default port (e.g., ssh_port: 2222)
#   3. Use Tailscale for encrypted access without exposing ports
#   4. Only enable when needed on trusted networks

install_ssh: false

# SSH Server (allow remote SSH into this device)
ssh_port: 22
ssh_import_authorized_keys: false   # Import authorized keys from private repo
ssh_authorized_keys: []             # List of key files from ssh-keys/ to authorize
                                    # Example: ["PC.pub", "VixenX.pub"]

# Key Generation (for this device to SSH out / authenticate)
ssh_key_name: ""                    # Key identifier (default: hostname)
ssh_generate_key: false             # Generate SSH key if not exists

# GitHub integration (requires gh CLI - installed if GitHub auth was used)
ssh_add_to_github: false            # Add public key to GitHub via gh CLI
ssh_save_to_private: false          # Save public key to private repo (backup)
ssh_configure_git: false            # Configure git to use SSH for GitHub

# Tailscale VPN
# -------------
# Zero-config VPN for secure access from anywhere.
# Free for personal use. Requires Tailscale account.
install_tailscale: false

# Remote Desktop / Game Streaming
# --------------------------------
# Sunshine: Game streaming server (pair with Moonlight client)
install_remote_desktop: false
install_sunshine: false
install_vnc: false

# =============================================================================
# GAMING ENHANCEMENTS
# =============================================================================

# Decky Loader
# ------------
# Plugin framework for Gaming Mode.
install_decky: true

# Decky Plugins
# -------------
# Plugins are installed from their GitHub/GitLab releases.
# Set enabled: true/false to control which plugins get installed.
decky_plugins:
  # Performance & System
  powertools:
    enabled: true
    description: "CPU/GPU control, per-game profiles"
    repo: "https://gitlab.com/NGnius/PowerTools"
    repo_type: "gitlab"

  autosuspend:
    enabled: false
    description: "Auto-suspend after inactivity"
    repo: "https://github.com/jurassicplayer/decky-autosuspend"
    repo_type: "github"

  battery_tracker:
    enabled: false
    description: "Track battery health over time"
    repo: "https://github.com/safijari/steam-deck-battery-tracker"
    repo_type: "github"

  # Game Info & Store
  protondb_badges:
    enabled: true
    description: "Show ProtonDB compatibility ratings"
    repo: "https://github.com/OMGDuke/protondb-decky"
    repo_type: "github"

  steamgriddb:
    enabled: true
    description: "Custom game artwork"
    repo: "https://github.com/SteamGridDB/decky-steamgriddb"
    repo_type: "github"

  hltb:
    enabled: false
    description: "How Long to Beat game times"
    repo: "https://github.com/morwy/hltb-for-deck"
    repo_type: "github"

  playtime:
    enabled: false
    description: "Detailed play time tracking"
    repo: "https://github.com/0u73r-h34v3n/SDH-PlayTime"
    repo_type: "github"

  isthereanydeal:
    enabled: false
    description: "Game deal notifications"
    repo: "https://github.com/JtdeGraaf/IsThereAnyDeal-DeckyPlugin"
    repo_type: "github"

  # Customization
  css_loader:
    enabled: false
    description: "Custom themes for Gaming Mode"
    repo: "https://github.com/DeckThemes/SDH-CssLoader"
    repo_type: "github"

  animation_changer:
    enabled: false
    description: "Custom boot/suspend animations"
    repo: "https://github.com/TheLogicMaster/SDH-AnimationChanger"
    repo_type: "github"

  # Connectivity
  bluetooth:
    enabled: false
    description: "Better Bluetooth management"
    repo: "https://github.com/Outpox/Bluetooth"
    repo_type: "github"

  bt_wake_control:
    enabled: false
    description: "Bluetooth wake control"
    repo: "https://gitlab.com/finewolf-projects/decky-plugin-bluetooth-wake-control"
    repo_type: "gitlab"

  tailscale_control:
    enabled: false
    description: "Tailscale VPN control from Gaming Mode"
    repo: "https://github.com/saumya-banthia/tailscale-control"
    repo_type: "github"

  kde_connect:
    enabled: false
    description: "KDE Connect integration"
    repo: "https://github.com/safijari/Decky-KDE-Connect"
    repo_type: "github"

  # Sync & Transfer
  decky_cloud_save:
    enabled: false
    description: "Cloud save sync for non-Steam games"
    repo: "https://github.com/GedasFX/decky-cloud-save"
    repo_type: "github"

  deckmtp:
    enabled: false
    description: "MTP file transfer support"
    repo: "https://github.com/dafta/DeckMTP"
    repo_type: "github"

  autoflatpaks:
    enabled: false
    description: "Auto-update Flatpak apps"
    repo: "https://github.com/jurassicplayer/decky-autoflatpaks"
    repo_type: "github"

  # Social & Notifications
  discord_status:
    enabled: false
    description: "Show game status on Discord"
    repo: "https://github.com/andrewburgess/steamdeck-discord-status"
    repo_type: "github"

  decky_notifications:
    enabled: false
    description: "Desktop notifications in Gaming Mode"
    repo: "https://github.com/Firemoon777/decky-notifications"
    repo_type: "github"

  # Audio
  magicpods:
    enabled: false
    description: "AirPods battery level & controls"
    repo: "https://github.com/steam3d/MagicPodsDecky"
    repo_type: "github"

# Proton Tools
# ------------
# Tools for Windows game compatibility.
install_proton_tools: true
install_protonup_qt: true
install_proton_ge: true
install_protontricks: true

# =============================================================================
# ANDROID (Waydroid)
# =============================================================================
# Runs Android apps on Steam Deck via Waydroid container.
# Uses: https://github.com/ryanrudolfoba/SteamOS-Waydroid-Installer
#
# After the playbook runs, launch "Waydroid Installer" from Desktop to
# complete setup. You'll choose your Android variant in the GUI.
#
# NOTE: Waydroid gets wiped on SteamOS updates. Re-run this playbook,
# then run the installer again. Your Android apps/data persist.

install_waydroid: false

# =============================================================================
# EMULATION
# =============================================================================
# Downloads EmuDeck for emulation setup.
# EmuDeck requires a GUI wizard - after running this playbook, launch
# EmuDeck from Desktop Mode to complete setup.

install_emudeck: false

# =============================================================================
# SD CARD
# =============================================================================
# Steam Deck SD card configuration. The playbook auto-detects if an SD card
# is present - these settings control what gets stored on it.

# Where to install emulation files (ROMs, BIOS, saves)
# Options: "auto", "internal", "sdcard"
#   - auto: Use SD card if present, otherwise internal
#   - internal: Always use internal storage (~/)
#   - sdcard: Always use SD card (fails if not present)
emulation_storage: "auto"

# Move Steam shader cache to SD card
# Shader cache can use 10-50GB+ on internal storage
# Moving it to SD card frees up space for games
move_shader_cache: false

# =============================================================================
# PATHS
# =============================================================================
# Generally don't need to change these

# Home directory
deck_home: "/home/deck"

# Emulation base path (computed based on storage preference)
# Don't edit this directly - set emulation_storage above instead
emulation_path: >-
  {%- if emulation_storage == 'sdcard' -%}
    {{ sdcard_path | default('/run/media/mmcblk0p1') }}/Emulation
  {%- elif emulation_storage == 'auto' and (sdcard_present | default(false)) -%}
    {{ sdcard_path | default('/run/media/mmcblk0p1') }}/Emulation
  {%- else -%}
    {{ deck_home }}/Emulation
  {%- endif -%}
